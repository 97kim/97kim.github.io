---
layout: post
title: 트랜잭션 매니저
subtitle: Spring
author: 97kim
categories: dev
banner:
  video:
  loop:
  volume:
  start_at:
  image: .
  opacity: 0.618
  background: "#000"
  height: "50vh"
  min_height: "38vh"
  heading_style: "font-size: 4.25em; font-weight: bold; text-decoration: underline"
  subheading_style: "color: gold"
tags: Spring TransactionManager
sidebar: []
---

스프링은 트랜잭션 동기화 매니저를 제공한다. 트랜잭션 동기화 매니저는 ThreadLocal을 사용하여 커넥션을 동기화해준다. 트랜잭션 매니저는 내부에서 트랜잭션 동기화 매니저를 사용한다.

1. 트랜잭션을 시작하려면 커넥션이 필요. 트랜잭션 매니저는 데이터소스를 통해 커넥션을 만들고 트랜잭션 시작
2. 트랜잭션 매니저는 트랜잭션이 시작된 커넥션을 트랜잭션 동기화 매니저에 보관
3. 리포지토리는 트랜잭션 동기화 매니저에 보관된 커넥션을 꺼내서 사용
4. 트랜잭션이 종료되면 트랜잭션 매니저는 트랜잭션 동기화 매니저에 보관된 커넥션을 통해 트랜잭션을 종료하고 커넥션 닫음

### 트랜잭션 매니저 AOP 흐름 (@Transactional 흐름)
![transcation-manager-aop](/assets/images/transaction-manager/transaction-manager-aop.png)
